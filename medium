sudo nano /etc/modprobe.d/filesystem.conf
install cramfs /bin/true
install freevxfs /bin/true
install hfs /bin/true
install hfsplus /bin/true
install jffs2 /bin/true
install squashfs /bin/true
install udf /bin/true
install usb-storage /bin/true


âœ” jiff2 à¤—à¤²à¤¤ à¤¥à¤¾ â†’ à¤¸à¤¹à¥€ à¤¨à¤¾à¤® jffs2

2. Modules à¤•à¥‹ à¤¤à¥à¤°à¤‚à¤¤ unload à¤•à¤°à¥‡à¤‚
modprobe -r cramfs freevxfs hfs hfsplus squashfs udf usb-storage 2>/dev/null


âœ… B. Secure Mount Points (/etc/fstab Hardening)

Security à¤¬à¤¢à¤¼à¤¾à¤¨à¥‡ à¤•à¥‡ à¤²à¤¿à¤ /tmp, /var/tmp, /dev/shm à¤ªà¤°
nodev, nosuid, noexec options à¤²à¤—à¤¾à¤¤à¥‡ à¤¹à¥ˆà¤‚à¥¤

vim /etc/fstab

tmpfs /tmp     tmpfs defaults,nodev,nosuid,noexec,mode=1777 0 0
tmpfs /var/tmp tmpfs defaults,nodev,nosuid,noexec,mode=1777 0 0
tmpfs /dev/shm tmpfs defaults,nodev,nosuid,noexec,mode=1777 0 0


mode=1777 â†’ world-writable but secure sticky bit

2. Remount Commands (à¤¬à¤¿à¤¨à¤¾ reboot à¤•à¥‡ changes à¤²à¤¾à¤—à¥‚)

mount -o remount,nodev /tmp
mount -o remount,nosuid /tmp
mount -o remount,noexec /tmp

mount -o remount,nodev /var/tmp
mount -o remount,nosuid /var/tmp
mount -o remount,noexec /var/tmp

mount -o remount,nodev /home

mount -o remount,nodev /dev/shm
mount -o remount,nosuid /dev/shm
mount -o remount,noexec /dev/shm

âœ… C. Apply System Updates (systemd reload etc.)
mount -a
systemctl daemon-reload


1. Mounts Verify à¤•à¤°à¥‡à¤‚

à¤¸à¤­à¥€ mount à¤¦à¤¿à¤–à¤¾à¤¨à¥‡ à¤•à¥‡ à¤²à¤¿à¤:
mount
à¤•à¥‡à¤µà¤² à¤¤à¥€à¤¨ mounts filter à¤•à¤°à¤•à¥‡ à¤¦à¥‡à¤–à¤¨à¥‡ à¤•à¥‡ à¤²à¤¿à¤:
mount | grep -E "/tmp|/var/tmp|/dev/shm"

Expected output à¤®à¥‡à¤‚ à¤¹à¥‹à¤¨à¤¾ à¤šà¤¾à¤¹à¤¿à¤:
nodev,nosuid,noexec,mode=1777

âœ” à¤…à¤—à¤° à¤¤à¥€à¤¨à¥‹à¤‚ options à¤¦à¤¿à¤–à¤¾à¤ˆ à¤¦à¥‡ à¤°à¤¹à¥‡ à¤¹à¥ˆà¤‚ â†’ OK
âŒ à¤…à¤—à¤° à¤à¤• à¤­à¥€ missing à¤¹à¥ˆ â†’ fstab fix à¤•à¤°à¥‡à¤‚

2. /etc/fstab Verify à¤•à¤°à¥‡à¤‚
grep -E "tmpfs.*tmp|var/tmp|dev/shm" /etc/fstab

Expected entry example:
tmpfs /tmp     tmpfs defaults,nodev,nosuid,noexec,mode=1777 0 0
tmpfs /var/tmp tmpfs defaults,nodev,nosuid,noexec,mode=1777 0 0
tmpfs /dev/shm tmpfs defaults,nodev,nosuid,noexec,mode=1777 0 0

âœ” à¤¯à¤¹ confirm à¤•à¤°à¤¤à¤¾ à¤¹à¥ˆ à¤•à¤¿ next reboot à¤ªà¤° à¤­à¥€ à¤¯à¤¹ settings apply à¤¹à¥‹à¤‚à¤—à¥€à¥¤

âœ… B. Verify Disabled Filesystem Kernel Modules

à¤†à¤ªà¤•à¥‡ system hardening à¤•à¥‡ parts à¤•à¥‡ à¤…à¤¨à¥à¤¸à¤¾à¤° à¤¨à¥€à¤šà¥‡ verification à¤•à¥‡ 3-steps à¤•à¤¾ full checklist à¤¦à¤¿à¤¯à¤¾ à¤¹à¥ˆà¥¤

à¤†à¤ªà¤•à¥‹ à¤¹à¤° module à¤•à¥‡ à¤²à¤¿à¤ à¤µà¤¹à¥€ 3 steps à¤šà¤²à¤¾à¤¨à¥‡ à¤¹à¥ˆà¤‚:

cramfs

freevxfs

hfs

hfsplus

jffs2

squashfs

udf

usb-storage

STEP 1 â€” modprobe.d config verify à¤•à¤°à¥‡à¤‚

Example: cramfs

grep cramfs /etc/modprobe.d/*

Expected:

install cramfs /bin/true

à¤…à¤—à¤° à¤¯à¤¹ line à¤¹à¥ˆ â†’ module disabled à¤¹à¥ˆà¥¤

STEP 2 â€” Check à¤•à¤°à¥‡à¤‚ module currently loaded à¤¤à¥‹ à¤¨à¤¹à¥€à¤‚
lsmod | grep cramfs
Expected:
(no output)


STEP 3 â€” Test: module load à¤•à¤°à¤¨à¥‡ à¤•à¥€ à¤•à¥‹à¤¶à¤¿à¤¶ à¤•à¤°à¥‡à¤‚ (load à¤¨à¤¹à¥€à¤‚ à¤¹à¥‹à¤¨à¤¾ à¤šà¤¾à¤¹à¤¿à¤)
modprobe cramfs 2>&1
Expected:

error

permission denied

or forced install failure
Example output:
modprobe: ERROR: could not insert 'cramfs': Operation not permitted
âœ” à¤‡à¤¸à¤•à¤¾ à¤®à¤¤à¤²à¤¬ module successfully disabled à¤¹à¥ˆà¥¤


ðŸ” Repeat Steps for All Modules

à¤†à¤ª à¤¯à¤¹à¥€ 3 commands à¤¹à¤° module à¤•à¥‡ à¤²à¤¿à¤ à¤šà¤²à¤¾à¤à¤:

freevxfs
grep freevxfs /etc/modprobe.d/*
lsmod | grep freevxfs
modprobe freevxfs 2>&1

hfs
grep hfs /etc/modprobe.d/*
lsmod | grep hfs
modprobe hfs 2>&1

hfsplus
grep hfsplus /etc/modprobe.d/*
lsmod | grep hfsplus
modprobe hfsplus 2>&1

jffs2
grep jffs2 /etc/modprobe.d/*
lsmod | grep jffs2
modprobe jffs2 2>&1

squashfs
grep squashfs /etc/modprobe.d/*
lsmod | grep squashfs
modprobe squashfs 2>&1

udf
grep udf /etc/modprobe.d/*
lsmod | grep udf
modprobe udf 2>&1

usb-storage
grep usb-storage /etc/modprobe.d/*
lsmod | grep usb-storage
modprobe usb-storage 2>&1
